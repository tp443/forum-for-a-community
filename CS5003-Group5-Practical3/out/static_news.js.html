<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: static/news.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: static/news.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * This is our document for the fundtionalities of the weather .
 * It enables our webpage to retrieve real-time data for specific towns
 * in the area of Five generated from several API's.
 *
 * @author dtb3,mb372,ty35
 * @date Mar 2018
 * @module js/news
 */


var apk = 'apiKey=6e086d4a8be1481a92f34d24e2bd5239';
var newsLength;
var title;
var newsImg;
var newsUrl;
var urlNews;
var keyword;
var toggle = false;

// get all sources and append to the dropdown list
var urlAllSource = 'https://newsapi.org/v2/sources?' + apk;
fetch(urlAllSource)
  .then(function(response) {
    return response.json();
  })
  // function to fill the dropdown list of sources
  .then(function(data) {
    allSource = data.sources;
    for (i = 0; i &lt; allSource.length; i++) {
      sourceId = allSource[i].id;
      sourceName = allSource[i].name;
      $("#source").append("&lt;option value='" + sourceId + "'>" + sourceName + "&lt;/option>")
    }
  })
  .catch(function(error) {
    console.log(error)
  })

/**
 *
 * @function sortNews - sort news by source or source and keyword
 * @param {string} place - user's choice of location
 */
function sortNews(place) {
  if (place == "Saint Andrews") {
    place = "St Andrews";
  } else if (place == "Home") {
    place = "Fife";
  } else {
    place = place;
  }

  toggle = true;
  $("#showNews").empty();
  var sourceSelected = $("#source").val();

  // judge whether a place is selected and point to different url
  if (toggle == true) {
    keyword = place;
    if (keyword == undefined) {
      keyword = $("#keyword").val();
      if (keyword == '') {
        urlNews = 'https://newsapi.org/v2/everything?sources=' + sourceSelected + '&amp;' + apk;
      } else {
        urlNews = 'https://newsapi.org/v2/everything?sources=' + sourceSelected + '&amp;q=' + keyword + '&amp;' + apk;
      }
    } else {
      urlNews = 'https://newsapi.org/v2/everything?sources=' + sourceSelected + '&amp;q=' + keyword + '&amp;' + apk;
    }
    toggle = false;
  }

  fetch(urlNews)
    .then(function(response) {
      return response.json();
    })
    .then(function(data) {
      allNews = data.articles;
      // if no news was returned, show message
      if (allNews.length == 0) {
        document.getElementById("showNews").innerHTML = "Oops! No news about " + keyword + "!" + "&lt;br>&lt;br>";
      }
      // if returned news is less than 5, then show all the news
      if (allNews.length &lt;= 5) {
        newsLength = allNews.length;
      } else {
        // only show 5 latest news
        newsLength = 5;
      }
      for (i = 0; i &lt; newsLength; i++) {
        title = allNews[i].title;
        newsImg = allNews[i].urlToImage;
        newsUrl = allNews[i].url;
        // generate news automatically
        // show title and related picture of the news
        $("#showNews").append("&lt;p id='newsTitle'> &lt;a href='" + newsUrl + "' id='newsUrl'>" + title + "&lt;/a>" + "&lt;img src='" + newsImg + "' id='newsImg'/>" + "&lt;/p>")
      }
    })
    .catch(function(error) {
      // error handling
      // if something wrong of the API or can't get the news successfully
      // show error message
      document.getElementById("showNews").innerHTML = "Oops! Errors!";
      console.log(error)
    })
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-js_api.html">js/api</a></li><li><a href="module-js_client.html">js/client</a></li><li><a href="module-js_dao.html">js/dao</a></li><li><a href="module-js_model.html">js/model</a></li><li><a href="module-js_news.html">js/news</a></li><li><a href="module-js_weather.html">js/weather</a></li></ul><h3>Classes</h3><ul><li><a href="module-js_model-ForumPost.html">ForumPost</a></li><li><a href="module-js_model-UserInfo.html">UserInfo</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri Apr 27 2018 09:44:01 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
